---
export const prerender = false;
export const partial = true;

// @ts-ignore
import { islands } from 'astro:internal/server-islands';

type RenderOptions = {
	componentPath: string; // TODO remove
	componentExport: string;
	props: Record<string, any>;
	slot: Record<string, any>;
}

const { method } = Astro.request;
if(method !== 'POST') {
	// TODO return error
}

const json = await Astro.request.text();
const options: RenderOptions = JSON.parse(json);

const module = await islands[options.componentPath]();
const Island = module[options.componentExport];

// TODO check auth
---
<Island />
